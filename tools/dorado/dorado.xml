<tool id="dorado" name="dorado" version="@CONTAINER_HASH@+galaxy0" python_template_version="3.5" profile="21.05">
    <macros>
        <import>macros.xml</import>
    </macros>
    <expand macro="xrefs"/>
    <expand macro="requirements"/>
    <command detect_errors="exit_code"><![CDATA[

ln -s '$pod5_file' ./reads.pod5 &&

dorado basecaller
--emit-sam
## TODO: get a list of models from /models (bundled with the container)
"/models/dna_r9.4.1_e8_fast@v3.4"
reads.pod5 
> output.sam

    ]]></command>
    <inputs>
        <param name="pod5_file" type="data" format="fast5" label="Raw fast5 file"/>
        <!-- <param name="model" type="select">
            <options from_data_table="dorado_models" />
        </param> -->
        <param name="index" type="select">
            <options from_data_table="bowtie_indexes" />
        </param>
    </inputs>
    <outputs>
        <data format="sam" name="out_sam" label="Output from dorado list-models" from_work_dir="output.sam"/>
    </outputs>
    <tests>
        <test expect_num_outputs="1">
            <param name="pod5_file" value="FAL00375_473bf0ed_0.ten_reads.pod5"/>
            <output name="out_sam">
                <assert_contents>
                    <has_text text="00777c4b-cbd6-4a79-8647-bbe5f5f3f3bf"/>
                    <has_size value="132024" delta="10000"/>
                </assert_contents>
            </output>
        </test>
    </tests>
    <help><![CDATA[

Basecall raw Nanopore data using Oxford Nanoporeâ€™s open source
`dorado <https://github.com/nanoporetech/dorado/>`__ basecaller.

The input is pod5 format.

TODO: If you have older data in fast5 format, you
can convert them using the pod5 convert tool.

    ]]></help>
</tool>
